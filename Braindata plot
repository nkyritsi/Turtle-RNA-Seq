##B plot

#Reference:
#http://www.gettinggeneticsdone.com/2014/05/r-volcano-plots-to-visualize-rnaseq-microarray.html

#Read-in /mnt/bd2/Turles/BrainGOonly_edit.csv
BrainGOdata <- read.csv("/home/micah/Documents/Test_document/v_plot_2nd/Plot_file.csv", header=TRUE, sep=",")

#Glance at data
head(BrainGOdata)

#load
library(ggplot2)

##make my sample readable to nxt three functions
as.numeric(BrainGOdata$B_1_minus_PPDE)

###Subset the data: remove NAs and zeros in eVal column
#Remove NAs
BrainGOdata <- BrainGOdata[!is.na(BrainGOdata$B_1_minus_PPDE),]

#Remove zeros
BrainGOdata <- BrainGOdata[BrainGOdata$B_1_minus_PPDE!="0", ]

sum(is.na(BrainGOdata$B_1_minus_PPDE))

typeof(BrainGOdata$B_1_minus_PPDE)

#Try plotting w/ eVal
with(BrainGOdata, plot(B_log2FoldChange, -log10(B_1_minus_PPDE), main="Volcano plot"))

#Produces 50 warnings:
#1: In min(x) : no non-missing arguments to min; returning Inf
#2: In max(x) : no non-missing arguments to max; returning -Inf

###Investigate what may cause error, e.g. "NA" and zeros
#See if there are NAs in eVal column
sum(is.na(BrainGOdata$B_1_minus_PPDE))

#See if there are zeros in eVal column
length(grep("0", BrainGOdata$))

###Subset the data: remove NAs and zeros in eVal column
#Remove NAs
BrainGOdata <- BrainGOdata[!is.na(BrainGOdata$B_1_minus_PPDE),]

View(BrainGOdata) 

#Remove zeros
BrainGOdata <- BrainGOdata[BrainGOdata$B_1_minus_PPDE!="0", ]

#Re-check to make sure NAs and zeros were cleared out
sum(is.na(BrainGOdata$B_1_minus_PPDE))

length(grep("0", BrainGOdata$B_1_minus_PPDE))

length(grep("0", BrainGOdata$B_1_minus_PPDE))

#For some reason, the above command says there are 579 zeros,
#but min() returns 1.72138e-180
min(BrainGOdata$B_1_minus_PPDE)

#Try plotting again
with(BrainGOdata, plot(B_log2FoldChange, -log10(B_1_minus_PPDE), main="Volcano plot",  xlab = "log2FoldChange", ylab = "-log10(pValue)", xlim=c(-6,6)))

# Add colored points: red if padj<0.05, orange of log2FC>1, green if both)
with(subset(Plot_file, B_1_minus_PPDE<.05 ), points(B_log2FoldChange, -log10(B_1_minus_PPDE), pch=20, col="red"))
with(subset(Plot_file, abs(B_log2FoldChange)>1), points(B_log2FoldChange, -log10(B_1_minus_PPDE), pch=20, col="orange"))
with(subset(Plot_file, B_1_minus_PPDE<.05 & abs(B_log2FoldChange)>1), points(B_log2FoldChange, -log10(B_1_minus_PPDE), pch=20, col="green"))
